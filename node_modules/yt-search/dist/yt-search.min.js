!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ytSearch=t()}}(function(){return function a(o,l,u){function s(e,t){if(!l[e]){if(!o[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=l[e]={exports:{}};o[e][0].call(i.exports,function(t){return s(o[e][1][t]||t)},i,i.exports,a,o,l,u)}return l[e].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)s(u[t]);return s}({1:[function(t,e,r){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var n,N=t("cheerio"),p=t("dasu"),d=t("async.parallellimit"),f=t("url"),U=t("querystring"),O=t("human-time"),m="https://www.youtube.com/results?",h={YT_SEARCH_QUERY_URI:"",hl:"en",gl:"US",category:"",pageStart:1,pageEnd:1};function i(o,l){var r=void 0,n=void 0,t=new Promise(function(t,e){r=t,n=e}),i=l;l=function(t,e){return i?i(t,e):t?n(t):void r(e)};var u=Object.assign({},h);if(!o)return l(new Error("No query given."));if(!(u="string"==typeof o?Object.assign(u,{query:o}):Object.assign(u,o)).YT_SEARCH_QUERY_URI){var e=m,s=u.hl||u.language||u.lang;s&&(e+="&hl="+s.slice(0,2)),u.gl&&(e+="&gl="+u.gl),u.category&&(e+="&category="+u.category),u.YT_SEARCH_QUERY_URI=e}if(u.videoId)return function(t,n){var e=void 0;"string"==typeof t&&(e=t);"object"===(void 0===t?"undefined":c(t))&&(e=t.videoId);var r="https://www.youtube.com/watch?hl=en&v="+e,i=f.parse(r);p.req(i,function(t,e,r){if(t)n(t);else{if(200!==e.status)return n("http status: "+e.status);try{!function(t,e){var r=N.load(t),n=r("#content"),i=r("meta[itemprop=videoId]",n).attr("content");if(!i)return e("video unavailable");var o="",l="",u="",s="",c="",p="",d=r('link[href*="/user/"]',n)||r('a[href*="/user/"]');if(d){var f=d.attr("href")||"";f&&(u=f.split("/").pop(),s="https://youtube.com/user/"+u)}c=r(".yt-user-info a").text().trim();var m=r('link[href*="/channel/"]',n)||r('a[href*="/channel/"');if(o=r("meta[itemprop=channelId]",n).attr("content"),l="https://youtube.com/channel/"+o,m){var h=m.attr("href")||"";h&&(o=h.split("/").pop(),l="https://youtube.com/channel/"+o)}var v="https://i.ytimg.com/vi/"+i+"/default.jpg",y="https://i.ytimg.com/vi/"+i+"/hqdefault.jpg",g=r('script[type="application/ld+json"]').text();try{var b=JSON.parse(g);p=b.itemListElement[0].item.name}catch(t){}var x="",w=r("meta[itemprop=duration]",n).attr("content");w&&(x=function(t){var e=t.slice(0,2),r=t.slice(2).toUpperCase();if("PT"!==e)return{toString:function(){return a[0]},seconds:0,timestamp:0};var n=r.match(/\d?\dH/),i=r.match(/\d?\dM/),o=r.match(/\d?\dS/);n=n&&n[0].slice(0,-1)||0,i=i&&i[0].slice(0,-1)||0,o=o&&o[0].slice(0,-1)||0,n=parseInt(n),i=parseInt(i),o=parseInt(o),r="",n&&(r+=n+":");i&&(r+=i+":");var l=60*n*60+60*i+o;return{toString:function(){return l+" seconds ("+r+")"},seconds:l,timestamp:r+=o}}(w));if(!x){var I=t.match(/approxDurationMs.*?(\d+)/);if(I&&I[1]){var U=I[1],S=function(t){var e="",r=t/36e5,n=t/6e4%60,i=t/36e5%60;r&&(e+=r+":");n&&(e+=n+":");String(i).length<2&&(e+="0");return e+=i}(U);x=q(S)}}var k=r("meta[itemprop=uploadDate]",n).attr("content"),j={title:r("meta[itemprop=name]",n).attr("content"),description:r("meta[itemprop=description]",n).attr("content"),url:r("link[itemprop=url]",n).attr("href"),videoId:i,seconds:Number(x.seconds),timestamp:x.timestamp,duration:x,views:Number(r("meta[itemprop=interactionCount]",n).attr("content")),genre:r("meta[itemprop=genre]",n).attr("content").toLowerCase(),uploadDate:k,ago:O(new Date(k)),thumbnail:v,image:y,author:{name:p||c,id:u||o,url:s||l,userId:u,userName:c,userUrl:s,channelId:o,channelName:p,channelUrl:l}};e(null,j)}(r,n)}catch(t){n(t)}}})}(u.videoId,l),i?void 0:t;if(u.listId)return function(t,n){var e=void 0;"string"==typeof t&&(e=t);"object"===(void 0===t?"undefined":c(t))&&(e=t.listId||t.playlistId);var r="https://www.youtube.com/playlist?hl=en&list="+e,i=f.parse(r);p.req(i,function(t,e,r){if(t)n(t);else{if(200!==e.status)return n("http status: "+e.status);try{!function(t,e){for(var r=N.load(t),n=r(".pl-header-thumb img").attr("src").split("?",2)[0],i=r(".pl-header-content"),a=r(".pl-header-title",i).text().trim(),o=r("#pl-header").attr("data-full-list-id"),l=r(".pl-header-details",i),u=r("li",l),s=D(r("a",u[0])),c=r(u[1]).text().trim(),p=Number(c.replace(/\D+/g,"")),d=r(u[2]).text().trim(),f=Number(d.replace(/\D+/g,"")),m=function(t){for(var e=t.trim().split(/[\s.-]+/),r=0;r<e.length;r++){var n=e.slice(r),i=n.join(" "),a=n.reverse().join(" "),o=new Date(i),l=new Date(a);if("Invalid Date"!==o.toString())return C(o);if("Invalid Date"!==l.toString())return C(l)}return""}(r(u[3]).text().trim()),h=r("#pl-load-more-destination .pl-video"),v=[],y=0;y<h.length;y++){var g=h[y],b=r(g).attr("data-title"),x=r(g).attr("data-video-id"),w="https://youtube.com/watch?v="+x+"&list="+o,I="https://i.ytimg.com/vi/"+x+"/default.jpg",U="https://i.ytimg.com/vi/"+x+"/hqdefault.jpg",S=r(".pl-video-owner a",g),k=D(S);v.push({title:b,videoId:x,listId:o,url:w,thumbnailUrl:I,thumbnailUrlHQ:U,owner:k.name,author:k})}var j={title:a,listId:o,url:"https://www.youtube.com/playlist?hl=en&list="+o,videoCount:p,views:Number(f),lastUpdate:m,thumbnail:n,items:v,author:s};e(null,j)}(r,n)}catch(t){n(t)}}})}(u.listId,l),i?void 0:t;return o=u.query||u.search,function(){var t=U.escape(o).split(/\s+/),n=u.YT_SEARCH_QUERY_URI+"&search_query="+t.join("+");0===u.pageStart&&(u.pageStart++,u.pageEnd++);for(var r=[],e=function(t){var e=t;r.push(function(r){!function(t,e,n){t+="&page="+e;var r=f.parse(t);p.req(r,function(t,e,r){if(t)n(t);else{if(200!==e.status)return n("http status: "+e.status);try{!function(t,e){for(var r=N.load(t),n=r(".yt-lockup"),i=[],a=[],o=0;o<n.length;o++){var l=n[o],u=r(".yt-lockup-content",l),s=r(".yt-lockup-title",u),c=r("a",s),p=r("span",s),d=(q(p.text()),c.attr("href")||""),f=U.parse(d.split("?",2)[1]);if(0===d.indexOf("/watch?")||0===d.indexOf("/user/")||0===d.indexOf("/channel/")){var m=f.v,h=f.list,v="unknown";m&&(v="video"),h&&(v="list"),(0<=d.indexOf("/channel/")||0<=d.indexOf("/user/"))&&(v="channel");var y=void 0;try{switch(v){case"video":y=x(r,l);break;case"list":y=w(r,l);break;case"channel":y=I(r,l)}}catch(t){i.push(t)}y&&(y.type=v,a.push(y))}}if(i.length)return e(i,a);e(null,a)}(r,n)}catch(t){n(t)}}})}(n,e,function(t,e){t?r(t):r(null,e)})})},i=u.pageStart;i<=u.pageEnd;i++)e(i);d(r,1,function(t,e){if(t)l(t);else{for(var r=[],n=0;n<e.length;n++)r=r.concat(e[0]);var i=r.filter(v),a=r.filter(g),o=r.filter(b);l(null,{videos:i.filter(y),playlists:a,lists:a,accounts:o,channels:o})}})}(),i?void 0:t}function v(t){return"video"===t.type}function y(t,e,r){var n=t.videoId;return r.findIndex(function(t){return n===t.videoId})===e}function g(t){return"list"===t.type}function b(t){return"channel"===t.type}function x(t,e){var r=t(".yt-lockup-content",e),n=t(".yt-lockup-title",r),i=t("a",n),a=q(t("span",n).text()),o=i.attr("href")||"",l=U.parse(o.split("?",2)[1]),u=l.v,s=(l.list,t(".yt-lockup-description",r).text().trim()),c=t("li",t(".yt-lockup-meta-info",r)),p=t(c[0]).text(),d=t(c[1]).text(),f=Number(d.split(" ")[0].split(",").join("").trim()),m="",h="",v="",y="",g=t('a[href^="/user/"]',r);g&&(v=(g.attr("href")||"").replace("/user/","").trim(),y=g.text().trim());var b=t('a[href^="/channel/"]',r);b&&(m=(b.attr("href")||"").replace("/channel/","").trim(),h=b.text().trim());var x="https://i.ytimg.com/vi/"+u+"/default.jpg",w="https://i.ytimg.com/vi/"+u+"/hqdefault.jpg";return{type:"video",title:i.text().trim(),description:s,url:"https://youtube.com/watch?v="+u,videoId:u,seconds:Number(a.seconds),timestamp:a.timestamp,duration:a,views:Number(f),thumbnail:x,image:w,ago:p,author:{name:y||h,id:v||m,url:g.attr("href")||b.attr("href"),userId:v,userName:y,userUrl:g.attr("href")||"",channelId:m,channelUrl:b.attr("href")||"",channelName:h}}}function w(t,e){var r=t(".yt-lockup-content",e),n=t("a",t(".yt-lockup-title",r)),i=n.text().trim(),a=n.attr("href"),o=U.parse(a.split("?",2)[1]),l=o.list,u=o.v,s="",c="",p="",d="",f="",m="",h=t(".yt-lockup-byline",r),v=t("a",h),y=v.attr("href")||"";y?(0<=y.indexOf("channel/")&&(c="https://youtube.com/channel/"+(s=y.split("/").pop()),p=v.text().trim()),0<=y.indexOf("user/")&&(f="https://youtube.com/user/"+(d=y.split("/").pop()),m=v.text().trim())):m=h.text().trim();var g=t(".sidebar",e).text().trim(),b=Number(g.replace(/\D+/g,"")),x=t("a",t("li.yt-lockup-playlist-item",r)[0]).attr("href"),w=U.parse(x.split("?",2)[1]).v,I=u||w;return{type:"list",title:i,url:"https://youtube.com/playlist?list="+l,listId:l,videoCountLabel:g,videoCount:b,thumbnail:"https://i.ytimg.com/vi/"+I+"/default.jpg",image:"https://i.ytimg.com/vi/"+I+"/hqdefault.jpg",author:{name:m||p,id:d||s,url:f||c,userId:d,userUrl:f,userName:m,channelId:s,channelUrl:c,channelName:p}}}function I(t,e){var r="https:"+t("img",e).attr("src"),n=t(".yt-lockup-content",e),i=t("a",t(".yt-lockup-title",n)),a=(i.text().trim(),i.attr("href")||""),o="",l="",u="",s="",c="",p="";0<=a.indexOf("channel/")&&(l="https://youtube.com/channel/"+(o=a.split("/").pop()),u=i.text().trim()),0<=a.indexOf("user/")&&(c="https://youtube.com/user/"+(s=a.split("/").pop()),p=i.text().trim());var d,f,m,h=t(".yt-lockup-meta-info",n).text().trim(),v=Number(h.replace(/\D+/g,"")),y=t(".yt-lockup-description",n).text().trim();return(f="url")in(d={type:"channel",title:p||u,description:y,url:m=c||l,videoCountLabel:h,videoCount:v,thumbnail:r,name:p||u,id:s||o})?Object.defineProperty(d,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):d[f]=m,d}function q(t){var e=t.split(/\s+/),r=e[e.length-1].replace(/[^:.\d]/g,"");if(!r)return{toString:function(){return e[0]},seconds:0,timestamp:0};for(;r[r.length-1].match(/\D/);)r=r.slice(0,-1);for(var n=(r=r.replace(/\./g,":")).split(/[:.]/),i=0,a=0,o=n.length-1;0<=o;o--)if(!(n[o].length<=0)){var l=n[o].replace(/\D/g,"");if(i+=parseInt(l)*(0<a?Math.pow(60,a):1),2<++a)break}return{toString:function(){return i+" seconds ("+r+")"},seconds:i,timestamp:r}}function D(t){var e="",r="",n="",i="",a="",o="",l=t.attr("href");return l?(0<=l.indexOf("channel/")&&(r="https://youtube.com/channel/"+(e=l.split("/").pop()),n=t.text().trim()),0<=l.indexOf("user/")&&(a="https://youtube.com/user/"+(i=l.split("/").pop()),o=t.text().trim()),{name:o||n,id:i||e,url:a||r,channelId:e,channelUrl:r,channelUrlText:n,userId:i,userUrl:a,userUrlText:o}):{}}function C(t){return t.getUTCFullYear()+"-"+t.getUTCMonth()+"-"+t.getUTCDate()}e.exports=function(t,e){return i(t,e)},e.exports.search=i,t.main===e&&(n="superman theme list",console.log("doing list search"),i(n,function(t,e){if(t)throw t;var r=e.videos,n=e.playlists,i=e.accounts;console.log("videos: "+r.length),console.log("playlists: "+n.length),console.log("accounts: "+i.length);for(var a=0;a<3;a++){var o=r[a],l=" ("+o.timestamp+")";console.log(o.title+l)}n.forEach(function(t){})}))},{"async.parallellimit":void 0,cheerio:void 0,dasu:void 0,"human-time":void 0,querystring:void 0,url:void 0}]},{},[1])(1)});