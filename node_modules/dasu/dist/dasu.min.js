!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o():"function"==typeof define&&define.amd?define(o):o()}(0,function(){"use strict";function t(t,o){var n="",r=t.data||t.json||"",a="";switch(typeof r){case"object":a=JSON.stringify(r),n="application/json";break;case"string":if(r.length>1&&("{"===r[0]||"["===r[0]))try{JSON.parse(r),console&&console.warn?console.warn("[WARNING] dasu: Sending data that may be JSON as text/plain"):console.log("[WARNING] dasu: Sending data that may be JSON as text/plain")}catch(t){}a=r,n="text/plain";break;default:a=""+r,n="text/plain"}t=Object.assign({},t),delete t.data,t.headers=Object.assign({},{"content-type":n},t.headers||{}),t.method=t.method||"GET",t.path=t.path||"/","/"!==t.path[0]&&(t.path="/"+t.path);var s={protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,path:t.path,method:t.method,headers:t.headers};return e(s,a,function(t,e,n){t||void 0===e?o(t):(!e.getResponseHeader&&e.headers&&(e.getResponseHeader=function(t){return e.headers[t]}),e.getAllResponseHeaders&&!e.headers&&(e.headers=e.getAllResponseHeaders()),void 0===e.status?e.status=e.statusCode:e.statusCode=e.status,o(void 0,e,n))})}var o={},e=function(){throw new Error("dasu: No request implemention specified in dasu.js")};if("undefined"!=typeof window&&void 0!==window.XMLHttpRequest)e=function(t,e,n){var r=new window.XMLHttpRequest;t.protocol=t.protocol||window.location.protocol||"http",":"!==t.protocol[t.protocol.length-1]&&(t.protocol+=":"),t.hostname=t.hostname||t.host||window.location.hostname;var a=80;t.protocol&&(a=-1!==t.protocol.indexOf("https")?443:80);var s=t.hostname.toLowerCase().trim(),i=window.location.hostname.toLowerCase().trim();-1!==s.indexOf(i)&&(a=window.location.port||a),t.port=t.port||a;var p=t.protocol+"//"+t.hostname+(t.port?":"+t.port:""),d=p+t.path;o.debug&&console.log("dasu: url ["+d+"]"),r.open(t.method,d,!0),r.onload=function(){n(null,r,r.responseText)},r.onerror=function(){var o=t.method.toUpperCase()+" "+d,a={name:"NetworkError",message:r.responseText||"NetworkError: XMLHttpRequest ("+o+")",desc:o,url:d,opts:t,data:e,origin:p,responseText:r.responseText};a.toString=function(){return a.message+"\n"+JSON.stringify(t).split(",").join(",\n")},n(a)};for(var c=Object.keys(t.headers),l=0;l<c.length;l++){var h=c[l],u=t.headers[h];r.setRequestHeader(h,u)}try{r.send(e)}catch(t){n(t)}return{abort:function(){r.abort()}}};else{var n=require,r=n("http"),a=n("https");e=function(t,o,e){t=t||{},t.hostname=t.hostname||t.host,t.protocol=t.protocol||"http";var n=r;t.protocol&&-1!==t.protocol.indexOf("https")&&(n=a),":"!==t.protocol[t.protocol.length-1]&&(t.protocol+=":");var s=n.request(t,function(t){var o="";t.on("data",function(t){o+=t}),t.on("end",function(){e(null,t,o)})});return s.on("error",function(t){e(t)}),s.write(o),s.end(),{abort:function(){s.abort()}}}}o.xhr=function(o,e){t(o,function(t,o,n){e(t,n)})},o.req=t,module.exports=o});